openerp.create_and_edit_many2one = function(instance) {
    var _t = instance.web._t,
   _lt = instance.web._lt;
    var QWeb = instance.web.qweb;

    instance.web.Session.include({
        session_init: function() {
            var self = this;
            return this._super.apply(this, arguments).then(function(res) {
                if (self.session_is_valid()) {
                    self.rpc('/create_and_edit_many2one/create_edit_allowed', {}).then(function(result) {
                        self.no_create_edit = result;
                    });
                    return res;
                }
            });
        }
    });
    instance.web.form.FieldMany2One.include({
        init: function() {
            this._super.apply(this, arguments);
        },
        evict_create_edit: function(values) {
            //for (i=0; i<vlaues.length; ++i) {
            //    if(values[i].label == '_t("Create and Edit...")') {
            values.splice(values.length-2, 2);
            //    }
            //}
            return values
        },
        get_search_result: function(search_val) {
            var self = this;
            console.log("Inside get_search_Val overridden :::: ",this.session.no_create_edit);
            super_res = this._super.apply(this, arguments);
            if (!this.session.no_create_edit) {
                return super_res;
            } else {
                return super_res.then(function(values) {
                    console.log("values are ::: ",values);
                    values = self.evict_create_edit(values)
                    return $.Deferred().resolve(values);
                });
            }
        },
    });
};